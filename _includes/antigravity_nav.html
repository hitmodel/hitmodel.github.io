<nav class="fixed w-full z-50 transition-all duration-300 bg-white/80 dark:bg-black/80 backdrop-blur-md shadow-sm"
  id="navbar">
  <div class="max-w-7xl mx-auto px-6 py-4 flex justify-between items-center">

    <!-- Logo -->
    <!-- Logo -->
    <!-- Logo -->
    <a href="{{ '/' | relative_url }}{% if page.lang == 'it' %}it/{% else %}en/{% endif %}"
      class="flex items-center gap-3 hover:opacity-80 transition-opacity">

      <!-- Desktop/Horizontal Logo -->
      <img src="/assets/images/logo/hit-logo-horizontal-transparent.png" alt="{{ site.title }}"
        class="h-12 w-auto dark:hidden hidden md:block">
      <img src="/assets/images/logo/hit-logo-horizontal-white-transparent.png" alt="{{ site.title }}"
        class="h-12 w-auto hidden dark:md:block">

      <!-- Mobile/Icon Logo -->
      <img src="/assets/images/logo/hit-logo-icon-only.png" alt="{{ site.title }}"
        class="h-10 w-auto dark:hidden md:hidden">
      <img src="/assets/images/logo/hit-logo-white-transparent.png" alt="{{ site.title }}"
        class="h-10 w-auto hidden dark:block dark:md:hidden">
    </a>

    <!-- Desktop Menu -->
    <div class="hidden md:flex items-center gap-8">
      {% assign nav_items = site.data.navigation_en %}
      {% if page.lang == 'it' %}
      {% assign nav_items = site.data.navigation_it %}
      {% endif %}

      {% for item in nav_items %}
      <a href="{{ item.url | relative_url }}"
        class="text-sm font-bold uppercase tracking-wide hover:text-brand-blue transition-colors relative group">
        {{ item.title }}
        <span class="absolute -bottom-1 left-0 w-0 h-0.5 bg-brand-blue transition-all group-hover:w-full"></span>
      </a>
      {% endfor %}

      <!-- Language Switcher (Desktop) -->
      <div class="flex items-center gap-2 text-sm font-bold uppercase tracking-wide">
        {% if page.lang == 'it' %}
        <span class="text-brand-blue">IT</span>
        <span class="text-gray-300">|</span>
        <a href="{{ page.url | replace: '/it/', '/en/' | relative_url }}"
          class="hover:text-brand-blue transition-colors">EN</a>
        {% else %}
        <a href="{{ page.url | replace: '/en/', '/it/' | relative_url }}"
          class="hover:text-brand-blue transition-colors">IT</a>
        <span class="text-gray-300">|</span>
        <span class="text-brand-blue">EN</span>
        {% endif %}
      </div>

      <!-- Theme Toggle -->
      <button onclick="toggleTheme()"
        class="w-10 h-10 rounded-full bg-gray-100 dark:bg-white/10 flex items-center justify-center hover:bg-gray-200 dark:hover:bg-white/20 transition-colors"
        aria-label="Toggle Theme">
        <i class="fas fa-moon dark:hidden"></i>
        <i class="fas fa-sun hidden dark:block text-yellow-400"></i>
      </button>
    </div>

    <!-- Mobile Menu Button -->
    <button class="md:hidden text-2xl" onclick="toggleMobileMenu()" aria-label="Menu">
      <i class="fas fa-bars"></i>
    </button>
  </div>
</nav>

<!-- Mobile Menu Overlay (OUTSIDE nav to avoid inheritance) -->
<div id="mobile-menu"
  class="fixed inset-0 bg-white dark:bg-neutral-950 z-[60] transform translate-x-full transition-transform duration-300 flex flex-col justify-center items-center gap-8">
  <button class="absolute top-6 right-6 text-3xl" onclick="toggleMobileMenu()">
    <i class="fas fa-times"></i>
  </button>

  {% assign nav_items = site.data.navigation_en %}
  {% if page.lang == 'it' %}
  {% assign nav_items = site.data.navigation_it %}
  {% endif %}

  {% for item in nav_items %}
  <a href="{{ item.url | relative_url }}" class="text-3xl font-black hover:text-brand-blue transition-colors"
    onclick="toggleMobileMenu()">{{ item.title }}</a>
  {% endfor %}

  <div class="flex gap-4 mt-8 flex-col items-center">
    <!-- Language Switcher (Mobile) -->
    <div class="flex items-center gap-4 text-xl font-bold uppercase tracking-wide mb-4">
      {% if page.lang == 'it' %}
      <span class="text-brand-blue border-b-2 border-brand-blue">Italiano</span>
      <a href="{{ page.url | replace: '/it/', '/en/' | relative_url }}"
        class="text-gray-500 hover:text-black dark:hover:text-white transition-colors">English</a>
      {% else %}
      <a href="{{ page.url | replace: '/en/', '/it/' | relative_url }}"
        class="text-gray-500 hover:text-black dark:hover:text-white transition-colors">Italiano</a>
      <span class="text-brand-blue border-b-2 border-brand-blue">English</span>
      {% endif %}
    </div>

    <button onclick="toggleTheme()" class="px-6 py-3 rounded-full bg-gray-100 dark:bg-white/10 font-bold">
      Toggle Theme
    </button>
  </div>
</div>

<script>
  // Navbar Scroll Effect
  // Navbar Scroll Effect - REMOVED to keep menu always readable
  // window.addEventListener('scroll', () => {
  //   const nav = document.getElementById('navbar');
  //   if (window.scrollY > 50) {
  //     nav.classList.add('bg-white/80', 'dark:bg-black/80', 'backdrop-blur-md', 'shadow-sm');
  //   } else {
  //     nav.classList.remove('bg-white/80', 'dark:bg-black/80', 'backdrop-blur-md', 'shadow-sm');
  //   }
  // });

  function toggleMobileMenu() {
    const menu = document.getElementById('mobile-menu');
    const isOpen = !menu.classList.contains('translate-x-full');

    if (isOpen) {
      menu.classList.add('translate-x-full');
      document.body.style.overflow = '';
    } else {
      menu.classList.remove('translate-x-full');
      document.body.style.overflow = 'hidden';
    }
  }
</script>